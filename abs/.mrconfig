[DEFAULT]
include = cat "$AB2_ARCH_DIR/mrcommon"

lib = 
        syncserver="rsync.archlinux.org"
        rsync_abs() {
            server="$1"
            repo="$2"
            arch="x86_64"
            rsargs='-mrtv --no-motd --delete-after --no-p --no-o --no-g'
            rsync $rsargs $server::abs/{$arch,any}/$repo/ . || true
        }
        

repoadd =
        buildpath=$(builddir_path "$PWD")
        package_repoadd "$buildpath" "$AB2_VAR_DIR/arch/abs"

repodel =
         buildpath=$(builddir_path "$PWD")
         package_repodel "$buildpath" "$AB2_VAR_DIR/arch/abs"

update =
        reponame=$(basename $MR_REPO)
        if [ "$MR_REPO" == "$PWD" ]; then
            rsync_abs "$syncserver" "$reponame"
        else     
            pkgname=$(basename "$PWD")
            rsync_abs "$syncserver" "$reponame/$pkgname"
        fi

[core]

[community]

[extra]

[testing]

[haskell-core]
sync = 
        cd "$MR_REPO"
        cblrepo sync

update =
        if [ "$MR_REPO" == "$PWD" ]; then
            cblrepo sync
            cblrepo pkgbuild $(cblrepo build base|tail -n +2)
        else     
            pkgname=$(basename "$PWD")
            cd "$MR_REPO"
            cblrepo pkgbuild $pkgname           
        fi
